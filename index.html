<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Iterative Keypoint Reward: Multi-Step Robotic Manipulation through Real-to-Sim-to-Real">
  <meta name="keywords" content="Robotic Manipulation, Foundation Models, Real2Sim, Sim2Real">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Iterative Keypoint Reward: Multi-Step Robotic Manipulation through Real-to-Sim-to-Real</title>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <!-- <link rel="icon" href="./static/images/favicon.svg"> -->

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>


<section class="hero">
  <div class="hero-body">
    <div class="container is-fullhd">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">A Real-to-Sim-to-Real Approach to Robotic Manipulation
            with VLM-Generated Iterative Keypoint Rewards</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a target="_blank" href="https://shivanshpatel35.github.io/">Shivansh Patel</a><sup>1*</sup>,
            </span>
            <span class="author-block">
              <a target="_blank" href="https://iker-robot.github.io/">Xinchen Yin</a><sup>1*</sup>,
            </span>
            <span class="author-block">
              <a target="_blank" href="https://huangwl18.github.io/">Wenlong Huang</a><sup>2</sup>,
            </span>
            <span class="author-block">
              <a target="_blank" href="https://www.gargshubham.com/">Shubham Garg</a><sup>3</sup>, 
            </span>
            <span class="author-block">
              <a target="_blank" href="https://www.amazon.science/author/hooshang-nayyeri">Hooshang Nayyeri</a><sup>3</sup>, 
            </span>
            <span class="author-block">
              <a target="_blank" href="https://profiles.stanford.edu/fei-fei-li">Li Fei-Fei</a><sup>2</sup>, 
            </span>
            <span class="author-block">
              <a target="_blank" href="https://slazebni.cs.illinois.edu/">Svetlana Lazebnik</a><sup>1</sup>, 
            </span>
            <span class="author-block">
              <a target="_blank" href="https://yunzhuli.github.io/">Yunzhu Li</a><sup>4</sup>
            </span>
          </div>

          <div class="is-size-5 affiliation">
            <sup>1</sup>University of Illinois at Urbana-Champaign,
            <sup>2</sup>Stanford University,
            <sup>3</sup>Amazon,
            <sup>4</sup>Columbia University
          </div>
          <div class="affiliation-note">
            <sup>*</sup> indicates equal contributions
          </div>

          <!-- TODO: change corresponding links below -->
          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="static/pdf/paper.pdf"
                   class="external-link button is-normal is-rounded is-dark" target="_blank">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <!-- <span class="link-block">
                <a href="https://arxiv.org/abs/2011.12948"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span> -->
              <!-- Video Link. -->
              <!-- <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span> -->
              <!-- Code Link. -->
              <!-- <span class="link-block">
                <a href="https://github.com/google/nerfies"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span> -->
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero teaser">
  <div class="container is-max-widescreen">
    <div class="hero-body">
      <div class="container">
        <div class="columns is-vcentered is-centered">
          <video id="teaser" autoplay muted loop controls style="max-width: 900px; width: 100%;" height="100%">
            <source src="static/videos/teaser.mp4" type="video/mp4">
          </video>
          </br>
        </div>
        <br>
        <h2 class="subtitle has-text-centered">
        </h2>
      </div>
    </div>
  </div>

<div class="container is-max-widescreen">
<div class="columns is-centered has-text-centered">
  <div class="column is-four-fifths">
    <h2 class="title is-3">Abstract</h2>
    <div class="content has-text-justified">
      <p>
        Task specification for robotic manipulation in open-world environments is inherently challenging. 
        Importantly, this process requires flexible and adaptive objectives that align with human intentions 
        and can evolve through iterative feedback. We introduce Iterative Keypoint Reward (IKER), a framework 
        that leverages VLMs to generate and refine visually grounded reward functions serving as dynamic task 
        specifications for multi-step manipulation tasks. Given RGB-D observations and free-form language 
        instructions, IKER samples keypoints from the scene and utilizes VLMs to generate Python-based reward 
        functions conditioned on these keypoints. These functions operate on the spatial relationships 
        between keypoints, enabling precise SE(3) control and leveraging VLMs as proxies to encode human 
        priors about robotic behaviors. We reconstruct real-world scenes in simulation and use the generated 
        rewards to train reinforcement learning policies, which are then deployed into the real worldâ€”forming 
        a real-to-sim-to-real loop. Our approach demonstrates notable capabilities across diverse scenarios, 
        including both prehensile and non-prehensile tasks, showcasing multi-step task execution, spontaneous 
        error recovery, and on-the-fly strategy adjustments. The results highlight IKER's effectiveness 
        in enabling robots to perform multi-step tasks in dynamic environments through iterative reward shaping 
        and minimal interaction.
      </p>
    </div>
  </div>
</div>



<section class="hero is-light is-small">
</section>


<section class="section">
  <div class="container is-max-desktop">

    <!-- TODO: Paper video. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Video</h2>
      </div>
    </div>
    <!--/ Paper video. -->
    <video id="teaser" loop controls height="100%" width="100%">
      <source src="static\videos\explanation.mp4"
              type="video/mp4">
    </video>
  </div>

</section>
<hr class="rounded">
<div class="rows">
  <h2 class="title is-3">Iterative Keypoint Reward (IKER)</h2>
  <div style="text-align: center;">
    <img src="static/images/iker.png" class="method-image" style="max-width: 60%;" />
  </div>
  <p class="content has-text-justified">Given RGB-D observations, we first obtain keypoints in the scene. 
    These keypoints, overlaid on the scene along with human commands and execution history, are passed through GPT-4o, which maps the keypoints into a reward function, allowing the robot to follow task objectives. 
    We call these reward functions Iterative Keypoint Reward (IKER).
    IKER is generated iteratively and is dynamic and adaptable. 
    By capturing spatial relationships between keypoints, IKER enables precise SE(3) control of objects.
  </p>
  <h2 class="title is-3">Method Overview</h2>
  <div style="text-align: center;">
    <img src="static/images/overview.svg" class="method-image" style="max-width: 100%;" />
  </div>
  <p class="content has-text-justified">Our framework follows a real-to-sim-to-real approach to robotic manipulation. 
    First, the real-world scene is reconstructed in simulation using 3D meshes of objects and point cloud of the environment. 
    GPT-4o generates IKER using real-world observations which is then used to train reinforcement learning policy in simulation
    This policy is subsequently deployed in the real-world. 
    Domain randomization is employed during training to bridge the real-to-sim and sim-to-real gap, making policies robust in real-world scenarios. 
    The framework supports both prehensile and non-prehensile tasks and includes features like multi-step task chaining and error recovery, which allow robots to adapt dynamically during task execution.
  </p>
</div>

<hr class="rounded">
<div class="rows">
  <h2 class="title is-3">Skills & Chaining</h2>

  <!-- TODO: descriptions -->
  <p class="content has-text-justified"></p>
  
  <div class="columns">
    <div class="column has-text-centered" style="display: flex; justify-content: center; gap: 20px;">
      
      <figure style="width: 45%;">
        <video id="skill3" controls autoplay loop muted width="100%">
          <source src="static/videos/Four_Shoes_new.MOV" type="video/mp4">
        </video>
        <figcaption>"Place the shoes on the rack."</figcaption>
      </figure>
      
      <figure style="width: 44%;">
        <video id="skill4" controls autoplay loop muted width="100%">
          <source src="static/videos/Shoe_Push_new.MOV" type="video/mp4">
        </video>
        <figcaption>"Place the shoes on the rack."</figcaption>
      </figure>
      
    </div>
  </div>
</div>

<hr class="rounded">
<div class="rows">
  <h2 class="title is-3">Robustness</h2>

  <!-- TODO: descriptions -->
  <p class="content has-text-justified">Since our plans are open-loop, our framework is robust to disturbances. On the left, a human intervenes with robot execution. On the right, the robot makes a mistake by placing the left shoe little far. In both the cases, robot is able to correct the behavior.</p>

  <div class="columns">
    <div class="column has-text-centered" style="display: flex; justify-content: center; gap: 20px; flex-wrap: wrap;">

      <!-- First Video: Robust to Human Intervention -->
      <figure style="width: 45%;">
        <video id="human1" controls autoplay loop muted width="100%">
          <source src="static/videos/Human_Intervention_new.MOV" type="video/mp4">
        </video>
        <figcaption>"Place the shoes on the rack"</figcaption>
      </figure>

      <!-- Second Video: Self Correction -->
      <figure style="width: 45%;">
        <video id="dist1" controls autoplay loop muted width="100%">
          <source src="static/videos/Minor_Adjustment_new.MOV" type="video/mp4">
        </video>
        <figcaption>"Place the shoes on the rack</figcaption>
      </figure>

    </div>
  </div>
</div>


<hr class="rounded">
<div class="rows">
  <h2 class="title is-3">Replan to Regrasp</h2>

  <!-- TODO: descriptions -->
  <p class="content has-text-justified">Our framework can predict new plans when previous plans are unfeasible. In this case, the robot fails grasping the book. It proposes a new plan to first push the book to make it graspable, and then stows it.</p>
  
  <div class="columns">
    <div class="column has-text-centered">
      <figure style="width: 60%; margin: 0 auto;">
        <video id="dist1" controls autoplay loop muted width="100%">
          <source src="static/videos/Replanning_new.MOV" type="video/mp4">
        </video>
        <figcaption>"Stow the book"</figcaption>
      </figure>
    </div>
  </div>
</div>

<hr class="rounded">
<div class="rows"></div>
  <h2 class="title is-3">Results</h2>
  <div style="text-align: center;">
    <img src="static/images/results.png" class="method-image" style="max-width: 80%;" />
  </div>
  <p class="content has-text-justified" style="margin-bottom: 0px;">We present results demonstrating the effectiveness of using keypoints and object poses to query VLMs in both simulation and real-world. The key findings are as follows:</p>
  <ul style="list-style-type: disc; margin-left: 20px; margin-top: 0px;">
    <li>Both keypoints and object poses effectively specify SE(3) task objectives, providing robust guidance for manipulation tasks.</li>
    <li>VLMs exhibit superior reasoning capabilities when processing keypoints compared to object poses, leading to more accurate task execution.</li>
    <li>The observed sim-to-real gap is minimal, highlighting the success of domain randomization in bridging real-to-sim and sim-to-real gaps.</li>
  </ul>
</div>


<!-- TODO: BibTeX -->
<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column">
        <div class="content has-text-centered">
          <p>
            Send feedback and questions to <a href="https://shivanshpatel35.github.io/">Shivansh Patel</a>. Website template borrowed from <a href="https://nerfies.github.io">Nerfies</a>,
            <a href="https://rekep-robot.github.io">ReKep</a>, and <a href="https://voxposer.github.io/">VoxPoser</a>
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
